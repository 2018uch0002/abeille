define: &l1 -3.
define: &l2 3.
#define: &l1 -5.514296811
#define: &l2 5.514296811

materials:
  - name: U-235-a
    id: 1
    total: [0.32640]
    absorption: [0.078336]
    fission: [0.065280]
    nu: [2.7]
    chi: [[1.]]
    scatter: [[0.248064]]
    P1: [[0.171052632]]

surfaces:
  - {type: zcylinder, x0: 0., y0: 0., r: 5.514296811, boundary: vacuum, id: 1}

cells:
  - {region: "-1", material: 1, id: 1}

universes:
  - {cells: [1], id: 1}

root-universe: 1

tally-filters:
  position-filters:
    - id: 1
      type: cylinder-filter
      origin: [0., 0., -100.]
      radius: 5.514296811
      pitch: [12, 12., 200.]
      pitch-x: 12.
      pitch-y: 0.
      pitch-z: 1.
      length: 200.
      axis: z
      shape: [1, 1, 0]

    - id: 2
      type: regular-cartesian-mesh
      low: [*l1, *l1, -10.]
      high:  [ *l2,  *l2,  10.]
      shape: [1000, 100, 10]

    - id: 3
      type: regular-cartesian-mesh
      low: [*l1, -0.11028593622, -2.]
      high:  [ *l2, 0.,  0.]
      shape: [1, 1, 1]
    
    - id: 4
      type: regular-cartesian-mesh
      low: [*l1, *l1, -10.]
      high:  [ *l2,  *l2,  10.]
      shape: [1, 1, 1]
    
    - id: 5
      type: regular-cartesian-mesh
      low: [-5.514296811, -5.514296811, -100.]
      high:  [ 5.514296811,  5.514296811,  100.]
      shape: [1, 1, 1]
    
    - id: 6
      type: cylinder-filter
      origin: [0., 0., -100.]
      radius: 5.514296811
      axis: z
      shape: [1, 1, 1]
      pitch: [12., 12., 200.]

    - id: 7
      type: regular-cartesian-mesh
      low: [-5.514296811, -0.06, -100.]
      high:  [ 5.514296811,  +0.06,  100.]
      shape: [1, 1, 1]
    
    - id: 8
      type: regular-cartesian-mesh
      low: [-5.514296811, -5.514296811, -100.]
      high:  [ 5.514296811,  5.514296811,  100.]
      shape: [1000, 1000, 1]
  energy-filters:
    - id: 1
      energy-bounds: [0., 1.]

tallies:
  - type: general
    position-filter: 2
    energy-filter: 1
    quantity: flux
    name: general-legendre
    estimator: collision

  - type: legendre-fet
    order: 2
    axes: [X]
    position-filter: 3
    energy-filter: 1
    quantity: flux
    name: fet-x
    estimator: collision

  - type: legendre-fet
    order: 2
    axes: [X, Y, Z]
    position-filter: 4
    energy-filter: 1
    quantity: flux
    name: fet-xy
    estimator: collision

  - type: general
    position-filter: 8
    energy-filter: 1
    quantity: flux
    name: general-zernike
    estimator: collision

  # - type: legendre-fet
  #   order: 2
  #   axes: [X]
  #   position-filter: 7
  #   energy-filter: 1
  #   quantity: flux
  #   name: fet-1
  #   estimator: collision
 
  - type: zernike-fet
    zernike-order: 5
    position-filter: 6
    energy-filter: 1
    quantity: flux
    name: zernike-fet
    estimator: collision

settings: 
  energy-mode: multi-group
  ngroups: 1
  energy-bounds: [0, 1]

simulation:
  mode: k-eigenvalue
  #nparticles: 1000000
  nparticles: 100000
  ngenerations: 550
  #ngenerations: 1050
  nignored: 50
  sources:
    - spatial:
        type: point
        position: [0., 0., 0.]
      direction:
        type: isotropic
      energy:
        type: mono-energetic
        energy: 0.5
      weight: 1.0